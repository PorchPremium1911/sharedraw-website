<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SharedDraw - Creative Drawing & Animation Platform</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        .canvas-container {
            border: 2px solid #e5e7eb;
            border-radius: 8px;
            background: white;
        }
        .tool-btn {
            transition: all 0.2s ease;
        }
        .tool-btn:hover {
            transform: translateY(-1px);
        }
        .active-tool {
            background: #3b82f6;
            color: white;
        }
        .modal {
            backdrop-filter: blur(4px);
        }
        .feed-post {
            transition: transform 0.2s ease;
        }
        .feed-post:hover {
            transform: translateY(-2px);
        }
    </style>
</head>
<body class="bg-gradient-to-br from-purple-50 to-blue-50 min-h-screen">
    <!-- Navigation -->
    <nav class="bg-white shadow-lg border-b-4 border-purple-500">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
            <div class="flex justify-between items-center h-16">
                <div class="flex items-center space-x-4">
                    <h1 class="text-2xl font-bold text-purple-600">üé® SharedDraw</h1>
                    <div id="modeButtons" class="flex space-x-2">
                        <button id="drawModeBtn" class="px-4 py-2 bg-purple-500 text-white rounded-lg hover:bg-purple-600 transition-colors disabled:bg-gray-400 disabled:cursor-not-allowed">
                            <span data-en="Drawing Mode" data-th="‡πÇ‡∏´‡∏°‡∏î‡∏ß‡∏≤‡∏î‡∏£‡∏π‡∏õ">Drawing Mode</span>
                        </button>
                        <button id="animModeBtn" class="px-4 py-2 bg-blue-500 text-white rounded-lg hover:bg-blue-600 transition-colors disabled:bg-gray-400 disabled:cursor-not-allowed">
                            <span data-en="Animation Mode" data-th="‡πÇ‡∏´‡∏°‡∏î‡πÅ‡∏≠‡∏ô‡∏¥‡πÄ‡∏°‡∏ä‡∏±‡∏ô">Animation Mode</span>
                        </button>
                    </div>
                </div>
                <div class="flex items-center space-x-4">
                    <select id="languageSelect" class="px-3 py-2 border border-gray-300 rounded-lg">
                        <option value="en">English</option>
                        <option value="th">‡πÑ‡∏ó‡∏¢</option>
                    </select>
                    <button id="loginBtn" class="px-4 py-2 bg-green-500 text-white rounded-lg hover:bg-green-600 transition-colors">
                        <span data-en="Login" data-th="‡πÄ‡∏Ç‡πâ‡∏≤‡∏™‡∏π‡πà‡∏£‡∏∞‡∏ö‡∏ö">Login</span>
                    </button>
                    <button id="registerBtn" class="px-4 py-2 bg-orange-500 text-white rounded-lg hover:bg-orange-600 transition-colors">
                        <span data-en="Register" data-th="‡∏™‡∏°‡∏±‡∏Ñ‡∏£‡∏™‡∏°‡∏≤‡∏ä‡∏¥‡∏Å">Register</span>
                    </button>
                    <button id="devLoginBtn" class="px-4 py-2 bg-red-500 text-white rounded-lg hover:bg-red-600 transition-colors">
                        <span data-en="Dev Login" data-th="‡πÄ‡∏Ç‡πâ‡∏≤‡∏™‡∏π‡πà‡∏£‡∏∞‡∏ö‡∏ö‡∏ô‡∏±‡∏Å‡∏û‡∏±‡∏í‡∏ô‡∏≤">Dev Login</span>
                    </button>
                </div>
            </div>
        </div>
    </nav>

    <!-- Main Content -->
    <div class="max-w-7xl mx-auto px-4 py-8">
        <div class="grid grid-cols-1 lg:grid-cols-3 gap-8">
            <!-- Drawing/Animation Area -->
            <div class="lg:col-span-2">
                <div id="drawingArea" class="bg-white rounded-xl shadow-lg p-6">
                    <div class="flex justify-between items-center mb-4">
                        <h2 id="canvasTitle" class="text-xl font-bold text-gray-800">
                            <span data-en="Drawing Canvas" data-th="‡∏û‡∏∑‡πâ‡∏ô‡∏ó‡∏µ‡πà‡∏ß‡∏≤‡∏î‡∏£‡∏π‡∏õ">Drawing Canvas</span>
                        </h2>
                        <button id="publishBtn" class="px-4 py-2 bg-purple-500 text-white rounded-lg hover:bg-purple-600 transition-colors">
                            <span data-en="Publish" data-th="‡πÄ‡∏ú‡∏¢‡πÅ‡∏û‡∏£‡πà">Publish</span>
                        </button>
                    </div>
                    
                    <!-- Login Required Message (shown when not logged in) -->
                    <div id="loginRequired" class="text-center py-16 bg-gray-50 rounded-lg">
                        <div class="text-6xl mb-4">üîí</div>
                        <h3 class="text-2xl font-bold text-gray-700 mb-4">
                            <span data-en="Login Required" data-th="‡∏ï‡πâ‡∏≠‡∏á‡πÄ‡∏Ç‡πâ‡∏≤‡∏™‡∏π‡πà‡∏£‡∏∞‡∏ö‡∏ö">Login Required</span>
                        </h3>
                        <p class="text-gray-600 mb-6">
                            <span data-en="Please login to access drawing and animation tools" data-th="‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡πÄ‡∏Ç‡πâ‡∏≤‡∏™‡∏π‡πà‡∏£‡∏∞‡∏ö‡∏ö‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÉ‡∏ä‡πâ‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á‡∏°‡∏∑‡∏≠‡∏ß‡∏≤‡∏î‡∏£‡∏π‡∏õ‡πÅ‡∏•‡∏∞‡πÅ‡∏≠‡∏ô‡∏¥‡πÄ‡∏°‡∏ä‡∏±‡∏ô">Please login to access drawing and animation tools</span>
                        </p>
                        <div class="space-x-4">
                            <button id="loginFromCanvas" class="px-6 py-3 bg-green-500 text-white rounded-lg hover:bg-green-600 transition-colors">
                                <span data-en="Login" data-th="‡πÄ‡∏Ç‡πâ‡∏≤‡∏™‡∏π‡πà‡∏£‡∏∞‡∏ö‡∏ö">Login</span>
                            </button>
                            <button id="registerFromCanvas" class="px-6 py-3 bg-orange-500 text-white rounded-lg hover:bg-orange-600 transition-colors">
                                <span data-en="Register" data-th="‡∏™‡∏°‡∏±‡∏Ñ‡∏£‡∏™‡∏°‡∏≤‡∏ä‡∏¥‡∏Å">Register</span>
                            </button>
                        </div>
                    </div>

                    <!-- Drawing Tools (hidden when not logged in) -->
                    <div id="drawingTools" class="hidden">
                        <!-- Tools -->
                        <div class="flex flex-wrap gap-2 mb-4 p-4 bg-gray-50 rounded-lg">
                            <button class="tool-btn px-3 py-2 bg-white border border-gray-300 rounded-lg hover:bg-gray-100" data-tool="pen">üñäÔ∏è Pen</button>
                            <button class="tool-btn px-3 py-2 bg-white border border-gray-300 rounded-lg hover:bg-gray-100" data-tool="brush">üñåÔ∏è Brush</button>
                            <button class="tool-btn px-3 py-2 bg-white border border-gray-300 rounded-lg hover:bg-gray-100" data-tool="eraser">üßπ Eraser</button>
                            <input type="color" id="colorPicker" value="#000000" class="w-12 h-10 border border-gray-300 rounded-lg cursor-pointer">
                            <input type="range" id="brushSize" min="1" max="20" value="3" class="w-20">
                            <button id="clearCanvas" class="px-3 py-2 bg-red-500 text-white rounded-lg hover:bg-red-600 transition-colors">
                                <span data-en="Clear" data-th="‡∏•‡πâ‡∏≤‡∏á">Clear</span>
                            </button>
                        </div>

                        <!-- Animation Controls (hidden by default) -->
                        <div id="animationControls" class="hidden mb-4 p-4 bg-blue-50 rounded-lg">
                            <div class="flex items-center space-x-4">
                                <button id="playBtn" class="px-4 py-2 bg-green-500 text-white rounded-lg hover:bg-green-600 transition-colors">‚ñ∂Ô∏è Play</button>
                                <button id="pauseBtn" class="px-4 py-2 bg-yellow-500 text-white rounded-lg hover:bg-yellow-600 transition-colors">‚è∏Ô∏è Pause</button>
                                <button id="addFrameBtn" class="px-4 py-2 bg-blue-500 text-white rounded-lg hover:bg-blue-600 transition-colors">+ Frame</button>
                                <span class="text-sm text-gray-600">Frame: <span id="currentFrame">1</span>/<span id="totalFrames">1</span></span>
                            </div>
                        </div>

                        <!-- Canvas -->
                        <div class="canvas-container">
                            <canvas id="drawingCanvas" width="600" height="400" class="w-full cursor-crosshair"></canvas>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Feed -->
            <div class="lg:col-span-1">
                <div class="bg-white rounded-xl shadow-lg p-6">
                    <h2 class="text-xl font-bold text-gray-800 mb-4">
                        <span data-en="Community Feed" data-th="‡∏ü‡∏µ‡∏î‡∏ä‡∏∏‡∏°‡∏ä‡∏ô">Community Feed</span>
                    </h2>
                    <div id="feedContainer" class="space-y-4 max-h-96 overflow-y-auto">
                        <div class="text-center text-gray-500 py-8">
                            <p data-en="No posts yet. Be the first to share your artwork!" data-th="‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏°‡∏µ‡πÇ‡∏û‡∏™‡∏ï‡πå ‡πÄ‡∏õ‡πá‡∏ô‡∏Ñ‡∏ô‡πÅ‡∏£‡∏Å‡∏ó‡∏µ‡πà‡πÅ‡∏ä‡∏£‡πå‡∏ú‡∏•‡∏á‡∏≤‡∏ô‡∏Ç‡∏≠‡∏á‡∏Ñ‡∏∏‡∏ì!">No posts yet. Be the first to share your artwork!</p>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Login Modal -->
    <div id="loginModal" class="hidden fixed inset-0 bg-black bg-opacity-50 modal flex items-center justify-center z-50">
        <div class="bg-white rounded-xl p-8 max-w-md w-full mx-4">
            <h3 class="text-2xl font-bold text-gray-800 mb-6">
                <span data-en="Login" data-th="‡πÄ‡∏Ç‡πâ‡∏≤‡∏™‡∏π‡πà‡∏£‡∏∞‡∏ö‡∏ö">Login</span>
            </h3>
            <form id="loginForm" class="space-y-4">
                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-2">
                        <span data-en="Username" data-th="‡∏ä‡∏∑‡πà‡∏≠‡∏ú‡∏π‡πâ‡πÉ‡∏ä‡πâ">Username</span>
                    </label>
                    <input type="text" id="loginUsername" class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-transparent">
                </div>
                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-2">
                        <span data-en="Password" data-th="‡∏£‡∏´‡∏±‡∏™‡∏ú‡πà‡∏≤‡∏ô">Password</span>
                    </label>
                    <input type="password" id="loginPassword" class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-transparent">
                </div>
                <div class="flex space-x-4">
                    <button type="submit" class="flex-1 bg-purple-500 text-white py-2 rounded-lg hover:bg-purple-600 transition-colors">
                        <span data-en="Login" data-th="‡πÄ‡∏Ç‡πâ‡∏≤‡∏™‡∏π‡πà‡∏£‡∏∞‡∏ö‡∏ö">Login</span>
                    </button>
                    <button type="button" id="closeLoginModal" class="flex-1 bg-gray-300 text-gray-700 py-2 rounded-lg hover:bg-gray-400 transition-colors">
                        <span data-en="Cancel" data-th="‡∏¢‡∏Å‡πÄ‡∏•‡∏¥‡∏Å">Cancel</span>
                    </button>
                </div>
            </form>
        </div>
    </div>

    <!-- Register Modal -->
    <div id="registerModal" class="hidden fixed inset-0 bg-black bg-opacity-50 modal flex items-center justify-center z-50">
        <div class="bg-white rounded-xl p-8 max-w-md w-full mx-4">
            <h3 class="text-2xl font-bold text-gray-800 mb-6">
                <span data-en="Register" data-th="‡∏™‡∏°‡∏±‡∏Ñ‡∏£‡∏™‡∏°‡∏≤‡∏ä‡∏¥‡∏Å">Register</span>
            </h3>
            <form id="registerForm" class="space-y-4">
                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-2">
                        <span data-en="Username" data-th="‡∏ä‡∏∑‡πà‡∏≠‡∏ú‡∏π‡πâ‡πÉ‡∏ä‡πâ">Username</span>
                    </label>
                    <input type="text" id="regUsername" class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-transparent">
                </div>
                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-2">
                        <span data-en="Email" data-th="‡∏≠‡∏µ‡πÄ‡∏°‡∏•">Email</span>
                    </label>
                    <input type="email" id="regEmail" class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-transparent">
                </div>
                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-2">
                        <span data-en="Password" data-th="‡∏£‡∏´‡∏±‡∏™‡∏ú‡πà‡∏≤‡∏ô">Password</span>
                    </label>
                    <input type="password" id="regPassword" class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-transparent">
                </div>
                <div class="flex space-x-4">
                    <button type="submit" class="flex-1 bg-orange-500 text-white py-2 rounded-lg hover:bg-orange-600 transition-colors">
                        <span data-en="Register" data-th="‡∏™‡∏°‡∏±‡∏Ñ‡∏£‡∏™‡∏°‡∏≤‡∏ä‡∏¥‡∏Å">Register</span>
                    </button>
                    <button type="button" id="closeRegisterModal" class="flex-1 bg-gray-300 text-gray-700 py-2 rounded-lg hover:bg-gray-400 transition-colors">
                        <span data-en="Cancel" data-th="‡∏¢‡∏Å‡πÄ‡∏•‡∏¥‡∏Å">Cancel</span>
                    </button>
                </div>
            </form>
        </div>
    </div>

    <!-- Developer Login Modal -->
    <div id="devLoginModal" class="hidden fixed inset-0 bg-black bg-opacity-50 modal flex items-center justify-center z-50">
        <div class="bg-white rounded-xl p-8 max-w-md w-full mx-4">
            <h3 class="text-2xl font-bold text-gray-800 mb-6">
                <span data-en="Developer Login" data-th="‡πÄ‡∏Ç‡πâ‡∏≤‡∏™‡∏π‡πà‡∏£‡∏∞‡∏ö‡∏ö‡∏ô‡∏±‡∏Å‡∏û‡∏±‡∏í‡∏ô‡∏≤">Developer Login</span>
            </h3>
            <form id="devLoginForm" class="space-y-4">
                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-2">
                        <span data-en="Developer Name" data-th="‡∏ä‡∏∑‡πà‡∏≠‡∏ô‡∏±‡∏Å‡∏û‡∏±‡∏í‡∏ô‡∏≤">Developer Name</span>
                    </label>
                    <select id="devName" class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-red-500 focus:border-transparent">
                        <option value="">Select Developer</option>
                        <option value="PorchPhaseXForever">PorchPhaseXForever</option>
                        <option value="ChingDEV01">ChingDEV01</option>
                    </select>
                </div>
                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-2">
                        <span data-en="Developer Code" data-th="‡∏£‡∏´‡∏±‡∏™‡∏ô‡∏±‡∏Å‡∏û‡∏±‡∏í‡∏ô‡∏≤">Developer Code</span>
                    </label>
                    <input type="password" id="devCode" class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-red-500 focus:border-transparent">
                </div>
                <div class="flex space-x-4">
                    <button type="submit" class="flex-1 bg-red-500 text-white py-2 rounded-lg hover:bg-red-600 transition-colors">
                        <span data-en="Login" data-th="‡πÄ‡∏Ç‡πâ‡∏≤‡∏™‡∏π‡πà‡∏£‡∏∞‡∏ö‡∏ö">Login</span>
                    </button>
                    <button type="button" id="closeDevLoginModal" class="flex-1 bg-gray-300 text-gray-700 py-2 rounded-lg hover:bg-gray-400 transition-colors">
                        <span data-en="Cancel" data-th="‡∏¢‡∏Å‡πÄ‡∏•‡∏¥‡∏Å">Cancel</span>
                    </button>
                </div>
            </form>
        </div>
    </div>

    <!-- Report Modal -->
    <div id="reportModal" class="hidden fixed inset-0 bg-black bg-opacity-50 modal flex items-center justify-center z-50">
        <div class="bg-white rounded-xl p-8 max-w-md w-full mx-4">
            <h3 class="text-2xl font-bold text-gray-800 mb-6">
                <span data-en="Report Post" data-th="‡∏£‡∏≤‡∏¢‡∏á‡∏≤‡∏ô‡πÇ‡∏û‡∏™‡∏ï‡πå">Report Post</span>
            </h3>
            <form id="reportForm" class="space-y-4">
                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-2">
                        <span data-en="Reason" data-th="‡πÄ‡∏´‡∏ï‡∏∏‡∏ú‡∏•">Reason</span>
                    </label>
                    <select id="reportReason" class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-red-500 focus:border-transparent">
                        <option value="inappropriate">Inappropriate Content</option>
                        <option value="spam">Spam</option>
                        <option value="harassment">Harassment</option>
                        <option value="copyright">Copyright Violation</option>
                        <option value="other">Other</option>
                    </select>
                </div>
                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-2">
                        <span data-en="Additional Details" data-th="‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î‡πÄ‡∏û‡∏¥‡πà‡∏°‡πÄ‡∏ï‡∏¥‡∏°">Additional Details</span>
                    </label>
                    <textarea id="reportDetails" rows="3" class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-red-500 focus:border-transparent"></textarea>
                </div>
                <div class="flex space-x-4">
                    <button type="submit" class="flex-1 bg-red-500 text-white py-2 rounded-lg hover:bg-red-600 transition-colors">
                        <span data-en="Submit Report" data-th="‡∏™‡πà‡∏á‡∏£‡∏≤‡∏¢‡∏á‡∏≤‡∏ô">Submit Report</span>
                    </button>
                    <button type="button" id="closeReportModal" class="flex-1 bg-gray-300 text-gray-700 py-2 rounded-lg hover:bg-gray-400 transition-colors">
                        <span data-en="Cancel" data-th="‡∏¢‡∏Å‡πÄ‡∏•‡∏¥‡∏Å">Cancel</span>
                    </button>
                </div>
            </form>
        </div>
    </div>

    <script>
        // Global variables
        let currentMode = 'drawing';
        let currentTool = 'pen';
        let isDrawing = false;
        let currentUser = null;
        let currentDeveloper = null;
        let currentLanguage = 'en';
        let animationFrames = [[]];
        let currentFrame = 0;
        let isPlaying = false;

        // Canvas setup
        const canvas = document.getElementById('drawingCanvas');
        const ctx = canvas.getContext('2d');
        ctx.lineCap = 'round';
        ctx.lineJoin = 'round';

        // Developer credentials
        const developers = {
            'PorchPhaseXForever': 'imadmin01',
            'ChingDEV01': 'imadmin02'
        };

        // Language switching
        function switchLanguage(lang) {
            currentLanguage = lang;
            document.querySelectorAll('[data-en]').forEach(element => {
                const text = element.getAttribute(`data-${lang}`);
                if (text) {
                    element.textContent = text;
                }
            });
        }

        // Mode switching
        function switchMode(mode) {
            currentMode = mode;
            const animControls = document.getElementById('animationControls');
            const canvasTitle = document.getElementById('canvasTitle');
            
            if (mode === 'animation') {
                animControls.classList.remove('hidden');
                canvasTitle.querySelector('span').textContent = currentLanguage === 'en' ? 'Animation Canvas' : '‡∏û‡∏∑‡πâ‡∏ô‡∏ó‡∏µ‡πà‡πÅ‡∏≠‡∏ô‡∏¥‡πÄ‡∏°‡∏ä‡∏±‡∏ô';
            } else {
                animControls.classList.add('hidden');
                canvasTitle.querySelector('span').textContent = currentLanguage === 'en' ? 'Drawing Canvas' : '‡∏û‡∏∑‡πâ‡∏ô‡∏ó‡∏µ‡πà‡∏ß‡∏≤‡∏î‡∏£‡∏π‡∏õ';
            }
        }

        // Drawing functions
        function startDrawing(e) {
            isDrawing = true;
            const rect = canvas.getBoundingClientRect();
            const x = e.clientX - rect.left;
            const y = e.clientY - rect.top;
            
            ctx.beginPath();
            ctx.moveTo(x, y);
        }

        function draw(e) {
            if (!isDrawing) return;
            
            const rect = canvas.getBoundingClientRect();
            const x = e.clientX - rect.left;
            const y = e.clientY - rect.top;
            
            ctx.lineWidth = document.getElementById('brushSize').value;
            ctx.strokeStyle = currentTool === 'eraser' ? '#FFFFFF' : document.getElementById('colorPicker').value;
            ctx.globalCompositeOperation = currentTool === 'eraser' ? 'destination-out' : 'source-over';
            
            ctx.lineTo(x, y);
            ctx.stroke();
        }

        function stopDrawing() {
            if (isDrawing) {
                isDrawing = false;
                ctx.beginPath();
                
                // Save frame for animation mode
                if (currentMode === 'animation') {
                    animationFrames[currentFrame] = ctx.getImageData(0, 0, canvas.width, canvas.height);
                }
            }
        }

        // Animation functions
        function addFrame() {
            animationFrames.push(ctx.getImageData(0, 0, canvas.width, canvas.height));
            currentFrame = animationFrames.length - 1;
            updateFrameDisplay();
            clearCanvas();
        }

        function playAnimation() {
            if (isPlaying) return;
            isPlaying = true;
            let frameIndex = 0;
            
            const interval = setInterval(() => {
                if (!isPlaying) {
                    clearInterval(interval);
                    return;
                }
                
                ctx.clearRect(0, 0, canvas.width, canvas.height);
                if (animationFrames[frameIndex]) {
                    ctx.putImageData(animationFrames[frameIndex], 0, 0);
                }
                
                frameIndex = (frameIndex + 1) % animationFrames.length;
            }, 200);
        }

        function pauseAnimation() {
            isPlaying = false;
        }

        function updateFrameDisplay() {
            document.getElementById('currentFrame').textContent = currentFrame + 1;
            document.getElementById('totalFrames').textContent = animationFrames.length;
        }

        function clearCanvas() {
            ctx.clearRect(0, 0, canvas.width, canvas.height);
        }

        // Modal functions
        function showModal(modalId) {
            document.getElementById(modalId).classList.remove('hidden');
        }

        function hideModal(modalId) {
            document.getElementById(modalId).classList.add('hidden');
        }

        // UI update functions
        function updateUIForLoginState() {
            const loginRequired = document.getElementById('loginRequired');
            const drawingTools = document.getElementById('drawingTools');
            const drawModeBtn = document.getElementById('drawModeBtn');
            const animModeBtn = document.getElementById('animModeBtn');
            
            if (currentUser) {
                // User is logged in - show drawing tools
                loginRequired.classList.add('hidden');
                drawingTools.classList.remove('hidden');
                drawModeBtn.disabled = false;
                animModeBtn.disabled = false;
            } else {
                // User is not logged in - show login required message
                loginRequired.classList.remove('hidden');
                drawingTools.classList.add('hidden');
                drawModeBtn.disabled = true;
                animModeBtn.disabled = true;
            }
        }

        // Authentication functions
        function login(username, password) {
            // Demo login - in real app, this would validate against a server
            currentUser = username;
            alert(`Welcome ${username}! You are now logged in.`);
            hideModal('loginModal');
            updateUIForLoginState();
        }

        function register(username, email, password) {
            // Demo registration - in real app, this would create account on server
            alert(`Account created for ${username}! Please login.`);
            hideModal('registerModal');
        }

        function devLogin(devName, devCode) {
            if (developers[devName] === devCode) {
                currentDeveloper = devName;
                alert(`Developer ${devName} logged in successfully!`);
                hideModal('devLoginModal');
            } else {
                alert('Invalid developer credentials!');
            }
        }

        function reportPost(reason, details) {
            if (currentDeveloper) {
                alert(`Report received by ${currentDeveloper}:\nReason: ${reason}\nDetails: ${details}`);
            } else {
                alert('Report submitted successfully! Our team will review it.');
            }
            hideModal('reportModal');
        }

        function publishArt() {
            if (!currentUser) {
                alert('Please login to publish your artwork!');
                return;
            }
            
            const artData = canvas.toDataURL();
            alert('Artwork published to the community feed!');
            
            // Add to feed (demo)
            const feedContainer = document.getElementById('feedContainer');
            const newPost = document.createElement('div');
            newPost.className = 'feed-post bg-gray-50 rounded-lg p-4 shadow-sm';
            newPost.innerHTML = `
                <div class="flex justify-between items-start mb-2">
                    <div class="flex items-center space-x-2">
                        <div class="w-8 h-8 bg-purple-500 rounded-full flex items-center justify-center text-white text-sm font-bold">${currentUser[0].toUpperCase()}</div>
                        <span class="font-semibold text-gray-800">${currentUser}</span>
                    </div>
                    <button class="report-btn text-red-500 hover:text-red-700 text-sm">‚ö†Ô∏è Report</button>
                </div>
                <img src="${artData}" class="w-full h-32 object-cover rounded-lg mb-2">
                <p class="text-sm text-gray-600 mb-2">New ${currentMode} creation! üé®</p>
                <div class="flex items-center space-x-4 text-sm text-gray-500">
                    <button class="hover:text-purple-500">‚ù§Ô∏è 0</button>
                    <button class="hover:text-blue-500">üí¨ 0</button>
                </div>
            `;
            feedContainer.insertBefore(newPost, feedContainer.firstChild);
        }

        // Event listeners
        document.addEventListener('DOMContentLoaded', function() {
            // Canvas events
            canvas.addEventListener('mousedown', startDrawing);
            canvas.addEventListener('mousemove', draw);
            canvas.addEventListener('mouseup', stopDrawing);
            canvas.addEventListener('mouseout', stopDrawing);

            // Tool selection
            document.querySelectorAll('.tool-btn').forEach(btn => {
                btn.addEventListener('click', function() {
                    document.querySelectorAll('.tool-btn').forEach(b => b.classList.remove('active-tool'));
                    this.classList.add('active-tool');
                    currentTool = this.dataset.tool;
                });
            });

            // Mode switching
            document.getElementById('drawModeBtn').addEventListener('click', () => {
                if (currentUser) {
                    switchMode('drawing');
                } else {
                    alert(currentLanguage === 'en' ? 'Please login to access drawing mode!' : '‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡πÄ‡∏Ç‡πâ‡∏≤‡∏™‡∏π‡πà‡∏£‡∏∞‡∏ö‡∏ö‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÉ‡∏ä‡πâ‡πÇ‡∏´‡∏°‡∏î‡∏ß‡∏≤‡∏î‡∏£‡∏π‡∏õ!');
                }
            });
            document.getElementById('animModeBtn').addEventListener('click', () => {
                if (currentUser) {
                    switchMode('animation');
                } else {
                    alert(currentLanguage === 'en' ? 'Please login to access animation mode!' : '‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡πÄ‡∏Ç‡πâ‡∏≤‡∏™‡∏π‡πà‡∏£‡∏∞‡∏ö‡∏ö‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÉ‡∏ä‡πâ‡πÇ‡∏´‡∏°‡∏î‡πÅ‡∏≠‡∏ô‡∏¥‡πÄ‡∏°‡∏ä‡∏±‡∏ô!');
                }
            });

            // Language switching
            document.getElementById('languageSelect').addEventListener('change', function() {
                switchLanguage(this.value);
            });

            // Modal triggers
            document.getElementById('loginBtn').addEventListener('click', () => showModal('loginModal'));
            document.getElementById('registerBtn').addEventListener('click', () => showModal('registerModal'));
            document.getElementById('devLoginBtn').addEventListener('click', () => showModal('devLoginModal'));

            // Modal close buttons
            document.getElementById('closeLoginModal').addEventListener('click', () => hideModal('loginModal'));
            document.getElementById('closeRegisterModal').addEventListener('click', () => hideModal('registerModal'));
            document.getElementById('closeDevLoginModal').addEventListener('click', () => hideModal('devLoginModal'));
            document.getElementById('closeReportModal').addEventListener('click', () => hideModal('reportModal'));

            // Form submissions
            document.getElementById('loginForm').addEventListener('submit', function(e) {
                e.preventDefault();
                const username = document.getElementById('loginUsername').value;
                const password = document.getElementById('loginPassword').value;
                login(username, password);
            });

            document.getElementById('registerForm').addEventListener('submit', function(e) {
                e.preventDefault();
                const username = document.getElementById('regUsername').value;
                const email = document.getElementById('regEmail').value;
                const password = document.getElementById('regPassword').value;
                register(username, email, password);
            });

            document.getElementById('devLoginForm').addEventListener('submit', function(e) {
                e.preventDefault();
                const devName = document.getElementById('devName').value;
                const devCode = document.getElementById('devCode').value;
                devLogin(devName, devCode);
            });

            document.getElementById('reportForm').addEventListener('submit', function(e) {
                e.preventDefault();
                const reason = document.getElementById('reportReason').value;
                const details = document.getElementById('reportDetails').value;
                reportPost(reason, details);
            });

            // Animation controls
            document.getElementById('playBtn').addEventListener('click', playAnimation);
            document.getElementById('pauseBtn').addEventListener('click', pauseAnimation);
            document.getElementById('addFrameBtn').addEventListener('click', addFrame);

            // Other controls
            document.getElementById('clearCanvas').addEventListener('click', clearCanvas);
            document.getElementById('publishBtn').addEventListener('click', publishArt);

            // Canvas login buttons
            document.getElementById('loginFromCanvas').addEventListener('click', () => showModal('loginModal'));
            document.getElementById('registerFromCanvas').addEventListener('click', () => showModal('registerModal'));

            // Report button delegation
            document.addEventListener('click', function(e) {
                if (e.target.classList.contains('report-btn')) {
                    showModal('reportModal');
                }
            });

            // Initialize
            updateFrameDisplay();
            updateUIForLoginState();
        });
    </script>
<script>(function(){function c(){var b=a.contentDocument||a.contentWindow.document;if(b){var d=b.createElement('script');d.innerHTML="window.__CF$cv$params={r:'96171a5d40277b41',t:'MTc1Mjg5NTQzNi4wMDAwMDA='};var a=document.createElement('script');a.nonce='';a.src='/cdn-cgi/challenge-platform/scripts/jsd/main.js';document.getElementsByTagName('head')[0].appendChild(a);";b.getElementsByTagName('head')[0].appendChild(d)}}if(document.body){var a=document.createElement('iframe');a.height=1;a.width=1;a.style.position='absolute';a.style.top=0;a.style.left=0;a.style.border='none';a.style.visibility='hidden';document.body.appendChild(a);if('loading'!==document.readyState)c();else if(window.addEventListener)document.addEventListener('DOMContentLoaded',c);else{var e=document.onreadystatechange||function(){};document.onreadystatechange=function(b){e(b);'loading'!==document.readyState&&(document.onreadystatechange=e,c())}}}})();</script></body>
</html>
