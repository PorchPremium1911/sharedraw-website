<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SharedDraw - Creative Drawing & Animation Platform</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        .canvas-container {
            border: 2px solid #e5e7eb;
            border-radius: 8px;
            background: white;
            position: relative;
        }
        .tool-btn {
            transition: all 0.2s ease;
        }
        .tool-btn:hover {
            transform: translateY(-1px);
        }
        .active-tool {
            background: #3b82f6 !important;
            color: white !important;
        }
        .modal {
            backdrop-filter: blur(4px);
        }
        .feed-post {
            transition: transform 0.2s ease;
        }
        .feed-post:hover {
            transform: translateY(-2px);
        }
        .animation-frame {
            border: 2px solid #ddd;
            margin: 5px;
            cursor: pointer;
        }
        .active-frame {
            border-color: #3b82f6;
        }
        .hidden {
            display: none !important;
        }
    </style>
</head>
<body class="bg-gradient-to-br from-purple-50 to-blue-50 min-h-screen">
    <!-- Navigation -->
    <nav class="bg-white shadow-lg border-b-4 border-purple-500">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
            <div class="flex justify-between items-center h-16">
                <div class="flex items-center space-x-4">
                    <h1 class="text-2xl font-bold text-purple-600">üé® SharedDraw</h1>
                    <div id="modeButtons" class="flex space-x-2">
                        <button id="drawModeBtn" class="px-4 py-2 bg-purple-500 text-white rounded-lg hover:bg-purple-600 transition-colors">
                            <span data-en="Drawing Mode" data-th="‡πÇ‡∏´‡∏°‡∏î‡∏ß‡∏≤‡∏î‡∏£‡∏π‡∏õ">Drawing Mode</span>
                        </button>
                        <button id="animModeBtn" class="px-4 py-2 bg-blue-500 text-white rounded-lg hover:bg-blue-600 transition-colors">
                            <span data-en="Animation Mode" data-th="‡πÇ‡∏´‡∏°‡∏î‡πÅ‡∏≠‡∏ô‡∏¥‡πÄ‡∏°‡∏ä‡∏±‡∏ô">Animation Mode</span>
                        </button>
                    </div>
                </div>
                <div class="flex items-center space-x-4">
                    <select id="languageSelect" class="px-3 py-2 border border-gray-300 rounded-lg">
                        <option value="en">English</option>
                        <option value="th">‡πÑ‡∏ó‡∏¢</option>
                    </select>
                    <div id="authButtons">
                        <button id="loginBtn" class="px-4 py-2 bg-green-500 text-white rounded-lg hover:bg-green-600 transition-colors">
                            <span data-en="Login" data-th="‡πÄ‡∏Ç‡πâ‡∏≤‡∏™‡∏π‡πà‡∏£‡∏∞‡∏ö‡∏ö">Login</span>
                        </button>
                        <button id="registerBtn" class="px-4 py-2 bg-orange-500 text-white rounded-lg hover:bg-orange-600 transition-colors">
                            <span data-en="Register" data-th="‡∏™‡∏°‡∏±‡∏Ñ‡∏£‡∏™‡∏°‡∏≤‡∏ä‡∏¥‡∏Å">Register</span>
                        </button>
                        <button id="devLoginBtn" class="px-4 py-2 bg-red-500 text-white rounded-lg hover:bg-red-600 transition-colors">
                            <span data-en="Dev Login" data-th="‡πÄ‡∏Ç‡πâ‡∏≤‡∏™‡∏π‡πà‡∏£‡∏∞‡∏ö‡∏ö‡∏ô‡∏±‡∏Å‡∏û‡∏±‡∏í‡∏ô‡∏≤">Dev Login</span>
                        </button>
                    </div>
                    <div id="userInfo" class="hidden flex items-center space-x-4">
                        <span id="welcomeText" class="text-gray-700"></span>
                        <span id="serviceStatus" class="hidden px-2 py-1 bg-gradient-to-r from-purple-500 to-blue-500 text-white text-xs rounded-full">
                            <span data-en="PorchXChing Active" data-th="PorchXChing ‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô‡πÑ‡∏î‡πâ">PorchXChing Active</span>
                        </span>
                        <button id="logoutBtn" class="px-4 py-2 bg-gray-500 text-white rounded-lg hover:bg-gray-600 transition-colors">
                            <span data-en="Logout" data-th="‡∏≠‡∏≠‡∏Å‡∏à‡∏≤‡∏Å‡∏£‡∏∞‡∏ö‡∏ö">Logout</span>
                        </button>
                    </div>
                </div>
            </div>
        </div>
    </nav>

    <!-- Main Content -->
    <div class="max-w-7xl mx-auto px-4 py-8">
        <div class="grid grid-cols-1 lg:grid-cols-3 gap-8">
            <!-- Drawing/Animation Area -->
            <div class="lg:col-span-2">
                <div id="drawingArea" class="bg-white rounded-xl shadow-lg p-6">
                    <div class="flex justify-between items-center mb-4">
                        <h2 id="canvasTitle" class="text-xl font-bold text-gray-800">
                            <span data-en="Drawing Canvas" data-th="‡∏û‡∏∑‡πâ‡∏ô‡∏ó‡∏µ‡πà‡∏ß‡∏≤‡∏î‡∏£‡∏π‡∏õ">Drawing Canvas</span>
                        </h2>
                        <button id="publishBtn" class="px-4 py-2 bg-purple-500 text-white rounded-lg hover:bg-purple-600 transition-colors">
                            <span data-en="Publish" data-th="‡πÄ‡∏ú‡∏¢‡πÅ‡∏û‡∏£‡πà">Publish</span>
                        </button>
                    </div>

                    <!-- Drawing Tools -->
                    <div id="drawingTools" class="flex flex-wrap gap-2 mb-4 p-4 bg-gray-50 rounded-lg">
                        <button id="penTool" class="tool-btn px-3 py-2 bg-blue-500 text-white rounded active-tool">
                            <span data-en="‚úèÔ∏è Pen" data-th="‚úèÔ∏è ‡∏õ‡∏≤‡∏Å‡∏Å‡∏≤">‚úèÔ∏è Pen</span>
                        </button>
                        <button id="brushTool" class="tool-btn px-3 py-2 bg-gray-200 rounded">
                            <span data-en="üñåÔ∏è Brush" data-th="üñåÔ∏è ‡∏û‡∏π‡πà‡∏Å‡∏±‡∏ô">üñåÔ∏è Brush</span>
                        </button>
                        <button id="eraserTool" class="tool-btn px-3 py-2 bg-gray-200 rounded">
                            <span data-en="üßπ Eraser" data-th="üßπ ‡∏¢‡∏≤‡∏á‡∏•‡∏ö">üßπ Eraser</span>
                        </button>
                        <button id="rectangleTool" class="tool-btn px-3 py-2 bg-gray-200 rounded">
                            <span data-en="‚¨ú Rectangle" data-th="‚¨ú ‡∏™‡∏µ‡πà‡πÄ‡∏´‡∏•‡∏µ‡πà‡∏¢‡∏°">‚¨ú Rectangle</span>
                        </button>
                        <button id="circleTool" class="tool-btn px-3 py-2 bg-gray-200 rounded">
                            <span data-en="‚≠ï Circle" data-th="‚≠ï ‡∏ß‡∏á‡∏Å‡∏•‡∏°">‚≠ï Circle</span>
                        </button>
                        <input type="color" id="colorPicker" value="#000000" class="w-12 h-10 rounded border-2">
                        <input type="range" id="brushSize" min="1" max="50" value="5" class="w-20">
                        <button id="clearCanvas" class="tool-btn px-3 py-2 bg-red-500 text-white rounded">
                            <span data-en="üóëÔ∏è Clear" data-th="üóëÔ∏è ‡∏•‡πâ‡∏≤‡∏á">üóëÔ∏è Clear</span>
                        </button>
                    </div>

                    <!-- Animation Controls -->
                    <div id="animationControls" class="hidden mb-4 p-4 bg-blue-50 rounded-lg">
                        <div class="flex items-center space-x-4 mb-4">
                            <button id="addFrameBtn" class="px-3 py-2 bg-green-500 text-white rounded">
                                <span data-en="+ Add Frame" data-th="+ ‡πÄ‡∏û‡∏¥‡πà‡∏°‡πÄ‡∏ü‡∏£‡∏°">+ Add Frame</span>
                            </button>
                            <button id="playAnimBtn" class="px-3 py-2 bg-blue-500 text-white rounded">
                                <span data-en="‚ñ∂Ô∏è Play" data-th="‚ñ∂Ô∏è ‡πÄ‡∏•‡πà‡∏ô">‚ñ∂Ô∏è Play</span>
                            </button>
                            <button id="stopAnimBtn" class="px-3 py-2 bg-red-500 text-white rounded">
                                <span data-en="‚èπÔ∏è Stop" data-th="‚èπÔ∏è ‡∏´‡∏¢‡∏∏‡∏î">‚èπÔ∏è Stop</span>
                            </button>
                            <label class="flex items-center space-x-2">
                                <span data-en="Speed:" data-th="‡∏Ñ‡∏ß‡∏≤‡∏°‡πÄ‡∏£‡πá‡∏ß:">Speed:</span>
                                <input type="range" id="animSpeed" min="100" max="1000" value="500" class="w-20">
                            </label>
                        </div>
                        <div id="framesList" class="flex space-x-2 overflow-x-auto p-2 bg-white rounded border">
                            <!-- Animation frames will be added here -->
                        </div>
                    </div>

                    <!-- Canvas -->
                    <div class="canvas-container">
                        <canvas id="drawingCanvas" width="800" height="600" class="block mx-auto cursor-crosshair"></canvas>
                    </div>
                </div>
            </div>

            <!-- Feed & Social -->
            <div class="lg:col-span-1">
                <div class="bg-white rounded-xl shadow-lg p-6">
                    <h3 class="text-lg font-bold text-gray-800 mb-4">
                        <span data-en="Community Feed" data-th="‡∏ü‡∏µ‡∏î‡∏ä‡∏∏‡∏°‡∏ä‡∏ô">Community Feed</span>
                    </h3>
                    <div id="feedContainer" class="space-y-4 max-h-96 overflow-y-auto">
                        <div class="text-center text-gray-500 py-8">
                            <p class="text-lg">üé®</p>
                            <p data-en="No posts yet. Create and publish your first artwork!" data-th="‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏°‡∏µ‡πÇ‡∏û‡∏™‡∏ï‡πå ‡∏™‡∏£‡πâ‡∏≤‡∏á‡πÅ‡∏•‡∏∞‡πÄ‡∏ú‡∏¢‡πÅ‡∏û‡∏£‡πà‡∏á‡∏≤‡∏ô‡∏®‡∏¥‡∏•‡∏õ‡∏∞‡πÅ‡∏£‡∏Å‡∏Ç‡∏≠‡∏á‡∏Ñ‡∏∏‡∏ì!">No posts yet. Create and publish your first artwork!</p>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Login Modal -->
    <div id="loginModal" class="hidden fixed inset-0 bg-black bg-opacity-50 modal flex items-center justify-center z-50">
        <div class="bg-white rounded-xl p-8 max-w-md w-full mx-4">
            <h2 class="text-2xl font-bold text-gray-800 mb-6">
                <span data-en="Login" data-th="‡πÄ‡∏Ç‡πâ‡∏≤‡∏™‡∏π‡πà‡∏£‡∏∞‡∏ö‡∏ö">Login</span>
            </h2>
            <form id="loginForm">
                <div class="mb-4">
                    <label class="block text-gray-700 text-sm font-bold mb-2">
                        <span data-en="Username" data-th="‡∏ä‡∏∑‡πà‡∏≠‡∏ú‡∏π‡πâ‡πÉ‡∏ä‡πâ">Username</span>
                    </label>
                    <input type="text" id="loginUsername" class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:border-purple-500" required>
                </div>
                <div class="mb-6">
                    <label class="block text-gray-700 text-sm font-bold mb-2">
                        <span data-en="Password" data-th="‡∏£‡∏´‡∏±‡∏™‡∏ú‡πà‡∏≤‡∏ô">Password</span>
                    </label>
                    <input type="password" id="loginPassword" class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:border-purple-500" required>
                </div>
                <div class="flex justify-between">
                    <button type="button" id="closeLoginModal" class="px-4 py-2 bg-gray-500 text-white rounded-lg hover:bg-gray-600">
                        <span data-en="Cancel" data-th="‡∏¢‡∏Å‡πÄ‡∏•‡∏¥‡∏Å">Cancel</span>
                    </button>
                    <button type="submit" class="px-4 py-2 bg-purple-500 text-white rounded-lg hover:bg-purple-600">
                        <span data-en="Login" data-th="‡πÄ‡∏Ç‡πâ‡∏≤‡∏™‡∏π‡πà‡∏£‡∏∞‡∏ö‡∏ö">Login</span>
                    </button>
                </div>
            </form>
        </div>
    </div>

    <!-- Register Modal -->
    <div id="registerModal" class="hidden fixed inset-0 bg-black bg-opacity-50 modal flex items-center justify-center z-50">
        <div class="bg-white rounded-xl p-8 max-w-md w-full mx-4">
            <h2 class="text-2xl font-bold text-gray-800 mb-6">
                <span data-en="Register" data-th="‡∏™‡∏°‡∏±‡∏Ñ‡∏£‡∏™‡∏°‡∏≤‡∏ä‡∏¥‡∏Å">Register</span>
            </h2>
            <form id="registerForm">
                <div class="mb-4">
                    <label class="block text-gray-700 text-sm font-bold mb-2">
                        <span data-en="Username" data-th="‡∏ä‡∏∑‡πà‡∏≠‡∏ú‡∏π‡πâ‡πÉ‡∏ä‡πâ">Username</span>
                    </label>
                    <input type="text" id="registerUsername" class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:border-purple-500" required>
                </div>
                <div class="mb-4">
                    <label class="block text-gray-700 text-sm font-bold mb-2">
                        <span data-en="Email" data-th="‡∏≠‡∏µ‡πÄ‡∏°‡∏•">Email</span>
                    </label>
                    <input type="email" id="registerEmail" class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:border-purple-500" required>
                </div>
                <div class="mb-6">
                    <label class="block text-gray-700 text-sm font-bold mb-2">
                        <span data-en="Password" data-th="‡∏£‡∏´‡∏±‡∏™‡∏ú‡πà‡∏≤‡∏ô">Password</span>
                    </label>
                    <input type="password" id="registerPassword" class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:border-purple-500" required>
                </div>
                <div class="flex justify-between">
                    <button type="button" id="closeRegisterModal" class="px-4 py-2 bg-gray-500 text-white rounded-lg hover:bg-gray-600">
                        <span data-en="Cancel" data-th="‡∏¢‡∏Å‡πÄ‡∏•‡∏¥‡∏Å">Cancel</span>
                    </button>
                    <button type="submit" class="px-4 py-2 bg-orange-500 text-white rounded-lg hover:bg-orange-600">
                        <span data-en="Register" data-th="‡∏™‡∏°‡∏±‡∏Ñ‡∏£‡∏™‡∏°‡∏≤‡∏ä‡∏¥‡∏Å">Register</span>
                    </button>
                </div>
            </form>
        </div>
    </div>

    <!-- Developer Login Modal -->
    <div id="devLoginModal" class="hidden fixed inset-0 bg-black bg-opacity-50 modal flex items-center justify-center z-50">
        <div class="bg-white rounded-xl p-8 max-w-md w-full mx-4">
            <h2 class="text-2xl font-bold text-red-600 mb-6">
                <span data-en="Developer Login" data-th="‡πÄ‡∏Ç‡πâ‡∏≤‡∏™‡∏π‡πà‡∏£‡∏∞‡∏ö‡∏ö‡∏ô‡∏±‡∏Å‡∏û‡∏±‡∏í‡∏ô‡∏≤">Developer Login</span>
            </h2>
            <form id="devLoginForm">
                <div class="mb-4">
                    <label class="block text-gray-700 text-sm font-bold mb-2">
                        <span data-en="Developer Name" data-th="‡∏ä‡∏∑‡πà‡∏≠‡∏ô‡∏±‡∏Å‡∏û‡∏±‡∏í‡∏ô‡∏≤">Developer Name</span>
                    </label>
                    <input type="text" id="devName" class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:border-red-500" required>
                </div>
                <div class="mb-6">
                    <label class="block text-gray-700 text-sm font-bold mb-2">
                        <span data-en="Access Code" data-th="‡∏£‡∏´‡∏±‡∏™‡πÄ‡∏Ç‡πâ‡∏≤‡∏ñ‡∏∂‡∏á">Access Code</span>
                    </label>
                    <input type="password" id="devCode" class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:border-red-500" required>
                </div>
                <div class="flex justify-between">
                    <button type="button" id="closeDevLoginModal" class="px-4 py-2 bg-gray-500 text-white rounded-lg hover:bg-gray-600">
                        <span data-en="Cancel" data-th="‡∏¢‡∏Å‡πÄ‡∏•‡∏¥‡∏Å">Cancel</span>
                    </button>
                    <button type="submit" class="px-4 py-2 bg-red-500 text-white rounded-lg hover:bg-red-600">
                        <span data-en="Login" data-th="‡πÄ‡∏Ç‡πâ‡∏≤‡∏™‡∏π‡πà‡∏£‡∏∞‡∏ö‡∏ö">Login</span>
                    </button>
                </div>
            </form>
        </div>
    </div>

    <!-- Report Modal -->
    <div id="reportModal" class="hidden fixed inset-0 bg-black bg-opacity-50 modal flex items-center justify-center z-50">
        <div class="bg-white rounded-xl p-8 max-w-md w-full mx-4">
            <h2 class="text-2xl font-bold text-red-600 mb-6">
                <span data-en="Report Content" data-th="‡∏£‡∏≤‡∏¢‡∏á‡∏≤‡∏ô‡πÄ‡∏ô‡∏∑‡πâ‡∏≠‡∏´‡∏≤">Report Content</span>
            </h2>
            <form id="reportForm">
                <div class="mb-4">
                    <label class="block text-gray-700 text-sm font-bold mb-2">
                        <span data-en="Reason" data-th="‡πÄ‡∏´‡∏ï‡∏∏‡∏ú‡∏•">Reason</span>
                    </label>
                    <select id="reportReason" class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:border-red-500" required>
                        <option value="">Select reason...</option>
                        <option value="inappropriate" data-en="Inappropriate content" data-th="‡πÄ‡∏ô‡∏∑‡πâ‡∏≠‡∏´‡∏≤‡πÑ‡∏°‡πà‡πÄ‡∏´‡∏°‡∏≤‡∏∞‡∏™‡∏°">Inappropriate content</option>
                        <option value="spam" data-en="Spam" data-th="‡∏™‡πÅ‡∏õ‡∏°">Spam</option>
                        <option value="harassment" data-en="Harassment" data-th="‡∏Å‡∏≤‡∏£‡∏Ñ‡∏∏‡∏Å‡∏Ñ‡∏≤‡∏°">Harassment</option>
                        <option value="copyright" data-en="Copyright violation" data-th="‡∏•‡∏∞‡πÄ‡∏°‡∏¥‡∏î‡∏•‡∏¥‡∏Ç‡∏™‡∏¥‡∏ó‡∏ò‡∏¥‡πå">Copyright violation</option>
                        <option value="other" data-en="Other" data-th="‡∏≠‡∏∑‡πà‡∏ô‡πÜ">Other</option>
                    </select>
                </div>
                <div class="mb-6">
                    <label class="block text-gray-700 text-sm font-bold mb-2">
                        <span data-en="Additional Details" data-th="‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î‡πÄ‡∏û‡∏¥‡πà‡∏°‡πÄ‡∏ï‡∏¥‡∏°">Additional Details</span>
                    </label>
                    <textarea id="reportDetails" class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:border-red-500" rows="4"></textarea>
                </div>
                <div class="flex justify-between">
                    <button type="button" id="closeReportModal" class="px-4 py-2 bg-gray-500 text-white rounded-lg hover:bg-gray-600">
                        <span data-en="Cancel" data-th="‡∏¢‡∏Å‡πÄ‡∏•‡∏¥‡∏Å">Cancel</span>
                    </button>
                    <button type="submit" class="px-4 py-2 bg-red-500 text-white rounded-lg hover:bg-red-600">
                        <span data-en="Submit Report" data-th="‡∏™‡πà‡∏á‡∏£‡∏≤‡∏¢‡∏á‡∏≤‡∏ô">Submit Report</span>
                    </button>
                </div>
            </form>
        </div>
    </div>

    <script>
        // Global variables
        let currentUser = null;
        let currentLanguage = 'en';
        let currentMode = 'drawing';
        let currentTool = 'pen';
        let isDrawing = false;
        let canvas, ctx;
        let animationFrames = [];
        let currentFrame = 0;
        let animationInterval = null;

        // Developer credentials
        const developers = {
            'PorchPhaseXForever': 'imadmin01',
            'ChingDEV01': 'imadmin02'
        };

        // PorchXChing Service - Premium features
        const porchXChingService = {
            features: ['Advanced Animation Tools', 'HD Export', 'Cloud Storage', 'Priority Support'],
            isActive: false,
            activateService: function(user) {
                if (user && user.type === 'developer') {
                    this.isActive = true;
                    showNotification('PorchXChing Service Activated! üöÄ', 'success');
                    return true;
                }
                return false;
            }
        };

        // User storage (empty by default - users must register)
        const users = {};

        // Initialize the application
        document.addEventListener('DOMContentLoaded', function() {
            initializeCanvas();
            setupEventListeners();
            updateLanguage();
        });

        function initializeCanvas() {
            canvas = document.getElementById('drawingCanvas');
            ctx = canvas.getContext('2d');
            ctx.lineCap = 'round';
            ctx.lineJoin = 'round';
            ctx.lineWidth = 5;
            ctx.strokeStyle = '#000000';
            
            // Add first animation frame
            animationFrames.push(ctx.getImageData(0, 0, canvas.width, canvas.height));
        }

        function setupEventListeners() {
            // Language selector
            document.getElementById('languageSelect').addEventListener('change', function() {
                currentLanguage = this.value;
                updateLanguage();
            });

            // Mode buttons
            document.getElementById('drawModeBtn').addEventListener('click', () => switchMode('drawing'));
            document.getElementById('animModeBtn').addEventListener('click', () => switchMode('animation'));

            // Auth buttons
            document.getElementById('loginBtn').addEventListener('click', () => showModal('loginModal'));
            document.getElementById('registerBtn').addEventListener('click', () => showModal('registerModal'));
            document.getElementById('devLoginBtn').addEventListener('click', () => showModal('devLoginModal'));
            document.getElementById('logoutBtn').addEventListener('click', logout);

            // Modal close buttons
            document.getElementById('closeLoginModal').addEventListener('click', () => hideModal('loginModal'));
            document.getElementById('closeRegisterModal').addEventListener('click', () => hideModal('registerModal'));
            document.getElementById('closeDevLoginModal').addEventListener('click', () => hideModal('devLoginModal'));
            document.getElementById('closeReportModal').addEventListener('click', () => hideModal('reportModal'));

            // Forms
            document.getElementById('loginForm').addEventListener('submit', handleLogin);
            document.getElementById('registerForm').addEventListener('submit', handleRegister);
            document.getElementById('devLoginForm').addEventListener('submit', handleDevLogin);
            document.getElementById('reportForm').addEventListener('submit', handleReport);

            // Drawing tools
            document.querySelectorAll('.tool-btn').forEach(btn => {
                btn.addEventListener('click', function() {
                    if (this.id.includes('Tool')) {
                        selectTool(this.id.replace('Tool', ''));
                    }
                });
            });

            document.getElementById('colorPicker').addEventListener('change', function() {
                ctx.strokeStyle = this.value;
                ctx.fillStyle = this.value;
            });

            document.getElementById('brushSize').addEventListener('input', function() {
                ctx.lineWidth = this.value;
            });

            document.getElementById('clearCanvas').addEventListener('click', clearCanvas);

            // Canvas drawing events
            canvas.addEventListener('mousedown', startDrawing);
            canvas.addEventListener('mousemove', draw);
            canvas.addEventListener('mouseup', stopDrawing);
            canvas.addEventListener('mouseout', stopDrawing);

            // Animation controls
            document.getElementById('addFrameBtn').addEventListener('click', addAnimationFrame);
            document.getElementById('playAnimBtn').addEventListener('click', playAnimation);
            document.getElementById('stopAnimBtn').addEventListener('click', stopAnimation);

            // Publish button
            document.getElementById('publishBtn').addEventListener('click', publishArtwork);

            // Report buttons
            document.addEventListener('click', function(e) {
                if (e.target.classList.contains('report-btn')) {
                    showModal('reportModal');
                }
            });

            // Comment functionality
            document.addEventListener('keypress', function(e) {
                if (e.target.classList.contains('comment-input') && e.key === 'Enter') {
                    addComment(e.target);
                }
            });

            // Like functionality
            document.addEventListener('click', function(e) {
                if (e.target.classList.contains('like-btn')) {
                    toggleLike(e.target);
                }
            });
        }

        function updateLanguage() {
            document.querySelectorAll('[data-en]').forEach(element => {
                const text = element.getAttribute(`data-${currentLanguage}`);
                if (text) {
                    element.textContent = text;
                }
            });

            // Update select options
            document.querySelectorAll('option[data-en]').forEach(option => {
                const text = option.getAttribute(`data-${currentLanguage}`);
                if (text) {
                    option.textContent = text;
                }
            });
        }

        function switchMode(mode) {
            currentMode = mode;
            const drawingTools = document.getElementById('drawingTools');
            const animationControls = document.getElementById('animationControls');
            const canvasTitle = document.getElementById('canvasTitle');

            if (mode === 'drawing') {
                drawingTools.classList.remove('hidden');
                animationControls.classList.add('hidden');
                canvasTitle.innerHTML = `<span data-en="Drawing Canvas" data-th="‡∏û‡∏∑‡πâ‡∏ô‡∏ó‡∏µ‡πà‡∏ß‡∏≤‡∏î‡∏£‡∏π‡∏õ">Drawing Canvas</span>`;
                document.getElementById('drawModeBtn').classList.add('bg-purple-600');
                document.getElementById('animModeBtn').classList.remove('bg-blue-600');
            } else {
                drawingTools.classList.add('hidden');
                animationControls.classList.remove('hidden');
                canvasTitle.innerHTML = `<span data-en="Animation Canvas" data-th="‡∏û‡∏∑‡πâ‡∏ô‡∏ó‡∏µ‡πà‡πÅ‡∏≠‡∏ô‡∏¥‡πÄ‡∏°‡∏ä‡∏±‡∏ô">Animation Canvas</span>`;
                document.getElementById('animModeBtn').classList.add('bg-blue-600');
                document.getElementById('drawModeBtn').classList.remove('bg-purple-600');
                updateFramesList();
            }
            updateLanguage();
        }

        function selectTool(tool) {
            currentTool = tool;
            document.querySelectorAll('.tool-btn').forEach(btn => {
                btn.classList.remove('active-tool');
            });
            document.getElementById(tool + 'Tool').classList.add('active-tool');

            // Update cursor
            switch(tool) {
                case 'eraser':
                    canvas.style.cursor = 'grab';
                    break;
                case 'pen':
                case 'brush':
                    canvas.style.cursor = 'crosshair';
                    break;
                default:
                    canvas.style.cursor = 'crosshair';
            }
        }

        function startDrawing(e) {
            isDrawing = true;
            const rect = canvas.getBoundingClientRect();
            const x = e.clientX - rect.left;
            const y = e.clientY - rect.top;

            if (currentTool === 'pen' || currentTool === 'brush') {
                ctx.beginPath();
                ctx.moveTo(x, y);
            } else if (currentTool === 'eraser') {
                ctx.globalCompositeOperation = 'destination-out';
                ctx.beginPath();
                ctx.arc(x, y, ctx.lineWidth, 0, 2 * Math.PI);
                ctx.fill();
            }
        }

        function draw(e) {
            if (!isDrawing) return;

            const rect = canvas.getBoundingClientRect();
            const x = e.clientX - rect.left;
            const y = e.clientY - rect.top;

            if (currentTool === 'pen' || currentTool === 'brush') {
                ctx.globalCompositeOperation = 'source-over';
                ctx.lineTo(x, y);
                ctx.stroke();
            } else if (currentTool === 'eraser') {
                ctx.globalCompositeOperation = 'destination-out';
                ctx.beginPath();
                ctx.arc(x, y, ctx.lineWidth, 0, 2 * Math.PI);
                ctx.fill();
            }
        }

        function stopDrawing() {
            if (isDrawing) {
                isDrawing = false;
                ctx.beginPath();
                
                // Update current animation frame
                if (currentMode === 'animation') {
                    animationFrames[currentFrame] = ctx.getImageData(0, 0, canvas.width, canvas.height);
                }
            }
        }

        function clearCanvas() {
            ctx.clearRect(0, 0, canvas.width, canvas.height);
            if (currentMode === 'animation') {
                animationFrames[currentFrame] = ctx.getImageData(0, 0, canvas.width, canvas.height);
            }
        }

        function addAnimationFrame() {
            const newFrame = ctx.createImageData(canvas.width, canvas.height);
            animationFrames.push(newFrame);
            currentFrame = animationFrames.length - 1;
            clearCanvas();
            updateFramesList();
        }

        function updateFramesList() {
            const framesList = document.getElementById('framesList');
            framesList.innerHTML = '';
            
            animationFrames.forEach((frame, index) => {
                const frameDiv = document.createElement('div');
                frameDiv.className = `animation-frame w-16 h-12 bg-gray-200 rounded cursor-pointer ${index === currentFrame ? 'active-frame' : ''}`;
                frameDiv.textContent = index + 1;
                frameDiv.addEventListener('click', () => selectFrame(index));
                framesList.appendChild(frameDiv);
            });
        }

        function selectFrame(index) {
            // Save current frame
            if (currentFrame < animationFrames.length) {
                animationFrames[currentFrame] = ctx.getImageData(0, 0, canvas.width, canvas.height);
            }
            
            // Load selected frame
            currentFrame = index;
            ctx.putImageData(animationFrames[index], 0, 0);
            updateFramesList();
        }

        function playAnimation() {
            if (animationInterval) return;
            
            const speed = document.getElementById('animSpeed').value;
            let frameIndex = 0;
            
            animationInterval = setInterval(() => {
                ctx.putImageData(animationFrames[frameIndex], 0, 0);
                frameIndex = (frameIndex + 1) % animationFrames.length;
            }, parseInt(speed));
        }

        function stopAnimation() {
            if (animationInterval) {
                clearInterval(animationInterval);
                animationInterval = null;
            }
        }

        function showModal(modalId) {
            document.getElementById(modalId).classList.remove('hidden');
        }

        function hideModal(modalId) {
            document.getElementById(modalId).classList.add('hidden');
        }

        function handleLogin(e) {
            e.preventDefault();
            const username = document.getElementById('loginUsername').value;
            const password = document.getElementById('loginPassword').value;

            if (users[username] && users[username] === password) {
                currentUser = { username, type: 'user' };
                updateUserInterface();
                hideModal('loginModal');
                showNotification('Login successful!', 'success');
            } else {
                showNotification('Invalid credentials!', 'error');
            }
        }

        function handleRegister(e) {
            e.preventDefault();
            const username = document.getElementById('registerUsername').value;
            const email = document.getElementById('registerEmail').value;
            const password = document.getElementById('registerPassword').value;

            if (users[username]) {
                showNotification('Username already exists!', 'error');
                return;
            }

            users[username] = password;
            currentUser = { username, email, type: 'user' };
            updateUserInterface();
            hideModal('registerModal');
            showNotification('Registration successful!', 'success');
        }

        function handleDevLogin(e) {
            e.preventDefault();
            const devName = document.getElementById('devName').value;
            const devCode = document.getElementById('devCode').value;

            if (developers[devName] && developers[devName] === devCode) {
                currentUser = { username: devName, type: 'developer' };
                
                // Activate PorchXChing Service for developers
                porchXChingService.activateService(currentUser);
                
                updateUserInterface();
                hideModal('devLoginModal');
                showNotification('Developer login successful!', 'success');
                
                // Show developer features
                setTimeout(() => {
                    showNotification('PorchXChing Premium Features Unlocked!', 'success');
                }, 1500);
            } else {
                showNotification('Invalid developer credentials!', 'error');
            }
        }

        function handleReport(e) {
            e.preventDefault();
            
            if (!currentUser) {
                showNotification('Please login to report!', 'error');
                return;
            }

            const reason = document.getElementById('reportReason').value;
            const details = document.getElementById('reportDetails').value;

            if (!reason) {
                showNotification('Please select a reason!', 'error');
                return;
            }

            // Send report to developers
            const reportData = {
                reason: reason,
                details: details,
                reporter: currentUser.username,
                timestamp: new Date().toISOString(),
                postId: Date.now() // Simple ID for demo
            };

            // Store report (in real app, this would go to a database)
            if (!window.reports) window.reports = [];
            window.reports.push(reportData);

            // Notify developers if they're online
            const devNotification = `üö® New Report from ${currentUser.username}: ${reason}`;
            console.log('Report sent to developers:', reportData);
            
            hideModal('reportModal');
            showNotification('Report sent to developers successfully!', 'success');
            
            // Reset form
            document.getElementById('reportForm').reset();
        }

        function logout() {
            currentUser = null;
            updateUserInterface();
            showNotification('Logged out successfully!', 'success');
        }

        function updateUserInterface() {
            const authButtons = document.getElementById('authButtons');
            const userInfo = document.getElementById('userInfo');
            const welcomeText = document.getElementById('welcomeText');
            const serviceStatus = document.getElementById('serviceStatus');

            if (currentUser) {
                authButtons.classList.add('hidden');
                userInfo.classList.remove('hidden');
                const userType = currentUser.type === 'developer' ? 'üë®‚Äçüíª Dev' : 'üë§';
                welcomeText.textContent = `${userType} ${currentUser.username}`;
                
                // Show PorchXChing service status for developers
                if (currentUser.type === 'developer' && porchXChingService.isActive) {
                    serviceStatus.classList.remove('hidden');
                } else {
                    serviceStatus.classList.add('hidden');
                }
            } else {
                authButtons.classList.remove('hidden');
                userInfo.classList.add('hidden');
                serviceStatus.classList.add('hidden');
                porchXChingService.isActive = false;
            }
        }

        function publishArtwork() {
            if (!currentUser) {
                showNotification('Please login to publish!', 'error');
                return;
            }

            const canvas = document.getElementById('drawingCanvas');
            const dataURL = canvas.toDataURL();
            
            // Create new post in feed
            const feedContainer = document.getElementById('feedContainer');
            const newPost = createFeedPost(currentUser.username, dataURL, 'New artwork!');
            feedContainer.insertBefore(newPost, feedContainer.firstChild);
            
            showNotification('Artwork published!', 'success');
        }

        function createFeedPost(username, imageData, description) {
            const postDiv = document.createElement('div');
            postDiv.className = 'feed-post bg-gray-50 rounded-lg p-4 shadow';
            postDiv.innerHTML = `
                <div class="flex justify-between items-start mb-2">
                    <div class="flex items-center space-x-2">
                        <div class="w-8 h-8 bg-purple-500 rounded-full flex items-center justify-center text-white font-bold">${username[0].toUpperCase()}</div>
                        <span class="font-semibold">${username}</span>
                    </div>
                    <button class="report-btn text-red-500 hover:text-red-700 text-sm">
                        <span data-en="Report" data-th="‡∏£‡∏≤‡∏¢‡∏á‡∏≤‡∏ô">Report</span>
                    </button>
                </div>
                <img src="${imageData}" class="w-full h-32 object-cover rounded mb-2" alt="User artwork">
                <p class="text-sm text-gray-600 mb-2">${description}</p>
                <div class="flex items-center space-x-4 text-sm text-gray-500">
                    <button class="like-btn hover:text-red-500">‚ù§Ô∏è 0</button>
                    <button class="comment-btn hover:text-blue-500">üí¨ 0</button>
                </div>
                <div class="comments-section mt-2 space-y-1"></div>
                <div class="mt-2">
                    <input type="text" placeholder="Add a comment..." class="comment-input w-full text-xs p-2 border rounded">
                </div>
            `;
            
            updateLanguage();
            return postDiv;
        }

        function addComment(input) {
            if (!currentUser) {
                showNotification('Please login to comment!', 'error');
                return;
            }

            const comment = input.value.trim();
            if (!comment) return;

            const commentsSection = input.parentElement.previousElementSibling;
            const commentDiv = document.createElement('div');
            commentDiv.className = 'text-xs text-gray-600 bg-gray-100 p-2 rounded';
            commentDiv.innerHTML = `<strong>${currentUser.username}:</strong> ${comment}`;
            commentsSection.appendChild(commentDiv);

            input.value = '';
        }

        function toggleLike(button) {
            if (!currentUser) {
                showNotification('Please login to like!', 'error');
                return;
            }

            const currentLikes = parseInt(button.textContent.split(' ')[1]);
            const newLikes = button.classList.contains('liked') ? currentLikes - 1 : currentLikes + 1;
            button.textContent = `‚ù§Ô∏è ${newLikes}`;
            button.classList.toggle('liked');
            button.classList.toggle('text-red-500');
        }

        function showNotification(message, type) {
            const notification = document.createElement('div');
            notification.className = `fixed top-4 right-4 px-6 py-3 rounded-lg text-white z-50 ${
                type === 'success' ? 'bg-green-500' : 'bg-red-500'
            }`;
            notification.textContent = message;
            document.body.appendChild(notification);

            setTimeout(() => {
                notification.remove();
            }, 3000);
        }
    </script>
<script>(function(){function c(){var b=a.contentDocument||a.contentWindow.document;if(b){var d=b.createElement('script');d.innerHTML="window.__CF$cv$params={r:'961739f5148f14aa',t:'MTc1Mjg5NjczMS4wMDAwMDA='};var a=document.createElement('script');a.nonce='';a.src='/cdn-cgi/challenge-platform/scripts/jsd/main.js';document.getElementsByTagName('head')[0].appendChild(a);";b.getElementsByTagName('head')[0].appendChild(d)}}if(document.body){var a=document.createElement('iframe');a.height=1;a.width=1;a.style.position='absolute';a.style.top=0;a.style.left=0;a.style.border='none';a.style.visibility='hidden';document.body.appendChild(a);if('loading'!==document.readyState)c();else if(window.addEventListener)document.addEventListener('DOMContentLoaded',c);else{var e=document.onreadystatechange||function(){};document.onreadystatechange=function(b){e(b);'loading'!==document.readyState&&(document.onreadystatechange=e,c())}}}})();</script></body>
</html>
